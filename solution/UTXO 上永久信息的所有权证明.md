## UTXO 上永久信息的所有权证明

#### _**问题：** 如何证明你对某个 UTXO 有控制权？（即：你拥有这 UTXO 的私钥。）_


_**方案一：**_

> **证明方** 向 **求证方** 提供满足该（包含某永久信息的）UTXO 花费条件的脚本（但 **并不真正** 打包交易提交到网络上进行支出操作），让其在本地运行该脚本并得到结果`true`，从而完成证明。
>
> _**缺点：**_ **不可靠。** 我们无法确保 **求正方** 不会恶意使用该脚本打包交易进行花费操作。而且即使对方不会立即执行恶意操作，也难免不会在后续任意时间执行该操作。


_**方案二：**_

> **证明方** 预先将该（包含某永久信息的）UTXO 支付给自己（或自己的另一个地址），由于收款方还是自己，那么说明这两个 UTXO 都是受 **证明方**  自己控制。
>
> _**好像哪里不对？**_ 如果这两个 UTXO 是别人的呢？**证明方** 并没有证明。
>
> _这个问题其实好解决：_ 花费另一个具有相同收款地址的 UTXO 给自己。似乎很麻烦，要花交易费，而且需要等待时间确认（至少一个出块）。
>
> 有没有捷径呢？其实是有的。


_**方案三：**_

> 基于方案二，由于 **证明方** 预先将该（包含某永久信息的）UTXO 支付给自己（或自己的另一个地址），形成了两个 TXO（一个已花费的 STXO，一个未花费的 UTXO）,那么 UTXO 所在的整条交易中包含了花费 STXO 所需的公钥，此时 **求证方** 只需要验证 **证明方** 是否拥有对应的私钥即可。方法很简单：**求证方** 生成一个具备 _**最小信息熵** 分布_ 特性的安全随机数 **R**，并用该公钥加密，然后发给 **证明方** 去解密得 **R'**，并将结果发回 **求证方**。如果 **R'** == **R**，则完成证明。我们把该方法暂记为 **随机数证明法。**
>
> _前面说了：**也可以花费给自己的另一个地址**_。那么这种方式怎么证明？这个`自己的另一个地址`必须是 _**当前地址所对应的公钥能够派生的**（原理参见 **分层确定性钱包** 的密钥对派生方案）。_ **求证方** 可以尝试进行派生操作，如果成功，那么由于私钥也是可以派生的，只要求证 **证明方** 拥有当前地址对应公钥的私钥，那么他就一定能够派生出`自己的另一个地址`对应的私钥，即可完成证明。对于当前私钥的求证方式同上。
>
> 但这种方式 _**是否有必要呢？**_ **没有必要！** 之所以要支付给自己的另一个地址，是为了暂时隐藏公钥，然而证明的时候又暴露了公钥，因此没有必要隐藏，那么也就没有必要支付给自己的另一个地址，只需支付给自己的同一个地址即可。

方案三看似已经完美了，但其实仍然可以 _**简化：**_


_**最终方案：**_

> 方案三的问题在于：公钥在一开始就已经公之于众了。那么何不直接将这个 UTXO 的收款地址改为公钥呢？这样就没有必要再支付给自己一遍了。**求证方** 只需要验证 **证明方** 是否拥有对应的私钥，方法同方案三的 **随机数证明法。**
>

最后更新：**反正总是要暴露公钥的，那么对于目标地址是公钥 hash 的 UTXO，证明方同时提供签名和公钥即可**。


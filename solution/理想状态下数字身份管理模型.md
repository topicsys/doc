## 理想状态下数字身份管理模型

##### v0.1.0
##### 作者：中成才


**身份是人们访问一切服务的钥匙**。通常，用户需要通过其身份来获得各项所需的服务，**公共服务机构**和**企业单位**会根据公民的真实身份来确定**是否应当为其提供**以及**提供何种服务**。即遵循 _**"身份 -> 服务"**_ 这样一个基本应用范式。  
在这些传统的实施例中，各个不同的服务提供方都需要储存用户的详细身份信息，这导致了人们身份数据的**副本** _广泛分布于相当多个不同单位实体_ 的档案库或数据库中。任何一个单位实体的数据泄露即造成用户信息泄露，这极大地增加了公民隐私泄露的风险。而泄露后潜在的 _二次散播风险_，也难以通过技术手段进行有效的**阻断**和**消除**。

随着互联网的全面普及和对经济、民生活动的全方位渗透，人们越来越适应并依赖于通过网络获取信息和服务。互联网企业通过网络获得了巨大的红利，传统企业纷纷向互联网转型，公共服务机构也越来越有意愿将各项服务功能互联网化，以提高效率并降低成本。  
根据《中华人民共和国网络安全法》对用户**实名制**（即：网络运营者应当要求用户提供真实身份信息）的要求，在互联网环境中，亦同样遵循 _**"身份 -> 服务"**_ 范式。人们通过绑定了身份的账户登录使用网银、通讯软件等；而不法分子也通过大量盗取的账户信息，伪装成别人的身份，从事网络违法犯罪活动。  
由于网络的特殊性，信息扩散的速度、广度和隐蔽性都远超以往（的任何途径）。伴随着企业数据库被盗、用户信息被曝光、传播、售卖等事件的屡次发生，人们对**隐私保护**的呼声也日渐高涨。而作为钥匙的用户账户和身份数据，对**私密性**的需求是不言而喻的，是网络安全所要解决的首要课题。

在传统实施例中，实体身份证作为公民身份信息的载体和实施实名制过程的必备材料，其弊端凸显。当身份管理成为许多问题的根源和焦点，一种**数字化、强隐私、简单便捷而又多用途**的公民身份解决方案是迫切需要的。


#### 一、模型概述

受区块链及密码学技术启发，本文提出一套全新的 _理想化**数字身份管理模型**_（简称：**身份模型**），以实现对用户（公民）身份 _全场景全业务的数字化综合管理与应用_。

_(Ａ). 本**身份模型**暂简述为下述实施例：_<br>
- **ID（标识符）化**。将各独立公民身份抽象为一个个独立标识符 ID，各系统围绕 ID 运转，_本模型的构建也围绕 ID 展开_；
- ID 基于公私钥加密技术生成，由用户去公安政务窗口申请数字身份，公安信息系统将 ID 写入区块链；
    > ID 除用于标识唯一身份外，还要用于签名、验证功能，以替代传统的账号密码登录模式：_**ID即账号，私钥即密码**_；<br>
    > 用户在终端手机上创建私钥，并将公钥输出到公安服务接口；<br>
    > 公安信息系统将 ID 绑定到旧系统中的公民身份数据库（其中包含了人脸、声纹等用于验证的信息）；<br>
    > ID 可随时变更（由用户申请），变更记录对公安透明，对外无痕。
- 引入区块链作为连接各服务系统的桥梁；
    > 区块链作为轻量级辅助网络，低侵入地连接已有的各服务提供方系统；<br>
    > 本方案的实施可弹性渐次进行。
- 区块链系统上记录 ID 的生命周期、公共安全评级、信用评级等记录，以及信息查询接口的指向 **(ID -> URI)** 映射；
    > ID 的生命周期包括：产生、更新、冻结、注销。冻结状态通常为用户自助申请：发现私钥被盗用、遗失或仅为防止 ID 被跟踪等。申请操作可使用手机在线执行；<br>
    > 注意：区块链中**不应**包含公民身份证上的基本信息。但公共安全评级、信用评级等易对社会造成不良影响的信息理应广而告之或易被查询；<br>
    > (ID -> URI) 表示用户（ID）详细信息的存储位置（URI），通常是其户籍所在地的公安局信息服务接口；<br>
    > 区块链基于 UTXO 模型，UTXO 本质上是一组可追溯的状态转换记录，适用于记录事物的变化，即：公民的最新状况。
- 各市县级公安服务接口以独立子链的形式接入该区块链网络；
    > 虽然公安机关从宏观上看是中心化的，但实际上分布于各地方县市，也是个分散化系统；<br>
    > 结构清晰，易于维护；<br>
    > 不同子链间可互不干扰地并行处理业务，提高整体吞吐量和运行效率；<br>
    > _(ID -> URI)_ 的 URI 根据实际行政区域不同可能不同。
- 公安节点写入数据，其它节点只读同步；
    > 公安信息系统将极少信息公开发布到链上，同时保障了公民隐私和公安的绝对控制权；<br>
    > 该区块链的性质属于 _全民参与的联盟链_，我们称之为**特定领域公链**。完全公开的链可极大地发挥本系统的功能优势（即使单纯以联盟链形式部署，合作单位只能理论可信，而并不事实可信）；<br>
    > 其它节点分布于公共服务机构、医院、学校、企业单位甚至个人等任何需要核实身份的单位。
- 服务提供方通过本地节点数据，完成部分业务操作；
    > 可执行简单的查询和有效性验证操作；<br>
    > 这部分操作往往较常用和频繁，本地操作可极大地减轻公安服务接口的访问压力；<br>
    > 保证和证明数据的准确性是区块链的基本能力，同时可保持数据是最新的；<br>
    > 本地可运行全节点或轻节点。
- 服务提供方通过　URI　执行的数据查询或操作，可能需要用户授权；
    > 请参见后文`业务授权`部分；<br>
    > 授权流程以用户通过手机与公安服务接口直接交互认证为基础；<br>
    > 根据不同的安全级别，认证方式会有不同，包括私钥、人脸、声纹等。
- 服务提供方通常有独立的 id 系统，可与身份 ID 绑定以实现实名制；
    > 服务提供方若在后续业务中发现 ID 已被链上状态置为失效，可从公安服务接口请求刷新到新 ID（这需要用户授权）；<br>
    > 公安可反查服务提供方调取用户资料。
- 各服务提供方可加入该区块链网络，以实现全网各业务实体互连接。
    > 将本模型泛化推广。


_(B). 本模型基于下述元逻辑构建：_<br>
    _**<h4>用户持 ID，业务问公安，公安管理数据。</h4>**_

* _说明：_<br>
1. 用户仅需持有 ID。在访问任何服务时，仅需出示该 ID；
    > ID 通过向公安机关申请获得；<br>
    > ID 的持有方式：手机 TEE + App。
2. 服务提供方在用户申请服务时，如果需要用户的详细资料，应当向 _公安服务接口_ 申请检索这些数据。公安服务接口有选择地同意、模糊或拒绝提供各具体条目的数据；
    > 用户若对数据访问或操作请求不知情，可选择拒绝登录或授权；<br>
    > 服务提供方，通常应当独立为用户建立服务 id，并绑定身份 ID；<br>
    > 服务 id 的获得和使用方式类似身份 ID，但作用范围和授权机制不同，如：应将"必须本人"的认证委托给了公安。
3. 公安部门通过线上信息系统管理并维护数据，包括但不限于：用户、组织团体或企业的 ID、基本资料、违法犯罪记录、信誉等各项与公共安全有关的信息。
并处理 _服务提供方_ 的业务请求，处理 _用户（公民）_ 的 ID 申请、变更、身份核验、授权等业务操作，以及受理安全警报等。公安服务接口根据服务提供方的**可信度等级**，以及
所申请的 _用户资料_ 的各项具体条目的**私密等级**，以确定在某时限内等待用户执行哪种等级的认证或授权流程，以及确定在认证后输出信息的模糊程度和条目。
    > 由于服务提供方有绑定存储用户的 ID，该 ID 可用于警方在必要时调取用户信息，以满足实名制要求；<br>
    > `模糊信息`，如年龄应该用未成年、青年、中年、老年等代替，地址、住址等的精度以及会话（session）时间间隔都应该有限制。
    
    * 为什么不让用户自己携带模糊信息？模糊信息往往需要更新 -> 何时更新？-> 定时更新？a. 没必要（如果在到达下一次更新时间时无使用需求的话）；b. 增加接口访问压力。因此 _**在需要时**_ 由服务提供方直接询问公安是较优的方案；
    * 公安服务接口应当对 _特定服务方_ 针对模糊信息的询问间隔设置限制（如果最低两周），或者根据上次的询问时间动态调整模糊混淆度，以避免根据变化分析出具体信息；
    * 公安服务接口应当注意避免在综合分析下得出具体信息。例如：某不可信服务提供方如 **商户** 对用户生日的要求，在提供具体日期的时候，就一定不能提供具体出生年份，而是用未成年、青年、中年、老年等模糊信息代替。


_(C). 用户数据的**私密等级**与**业务授权**：_<br>
1. 公开。_任何人_ 可查询/操作；
2. 需要用户授权。涵盖了用户本人的查询/操作；
    > 用户登录/授权服务的方式采用私钥签名机制。即：<br>
    a. 服务方生成一个随机数让用户私钥签名；或者<br>
    b. 由公安接口生成随机数和状态码返回给服务提供方，服务提供方要求用户对该随机数用私钥签名，再经由服务提供者返回给公安以实现登录/授权。
3. 必须本人。
    > 公安接口直接与用户客户端交互，通过人脸、语音声纹等生物识别技术进行本人认证。比较可行的方案是：公安给出一个随机数，让用户在视频中读出（随机数确保视频为最新的，人脸、声纹识别出是不是本人）。
    
    * 可由用户自行设置（有默认设置，用户可提高具体条目的私密等级，不可降低于默认值）；
    * **操作**。指：办理变更类业务。


#### 二、模型特点

在本模型框架下，用户（公民）身份具有以下特点：<br>
- 保障公安部门在本系统中对信息的绝对主控权；
- 数字化。一切相关业务的交互通过电子设备和互联网进行；
    > 基于无纸化办公的普及，数字化身份的应用是无障碍的。
- 难伪造，易挂失；
    > ID 基于密码学公私钥签名技术。其中，私钥存储于手机的 TEE 可信执行环境，永远无法取出（若换手机，可以重新申请新 ID）。
- 身份证兼容，可替代或将 ID 内置于身份证；
    > 兼容，指基于身份证信息之上构建。
- 一 ID 通用，适用于全场景实名制业务需求，并支持冻结、挂失和变更等操作；
    > 大多数功能可在线自助操作，变更操作仅公安内部存档，对外无痕。
- 受控的强隐私保护。对公安透明，对服务提供方模糊，对业务实体匿名；
    > 基于密码学的交互模型，确保身份隐私仅受控于公安部门。而公网中仅流通可废止的 ID 号码，难以跟踪。
- 本地验证，可**取代 CA**。服务提供方在运行相关区块链节点的情况下，可以在本地进行基本的登录验证操作，分散服务压力；
    > 任何业务实体，以及民众个体之间亦可通过手机交互，互相核实身份；<br>
    > 基于区块链特有性质：各节点存储数据的实时性、一致性、可证明性；<br>
    > 和本模型的潜在事实：存在于区块链上的数据真实可靠。
- 事件互斥，可追溯；
    > 可确保在同一时刻操作的唯一性，可实现对泄露伪造等问题的及时发现，也便于公安对案件的分析追踪。
- 防篡改、公安备案与数字化追责。
    > 传统区块链忽略恶意，政务系统区块链应当追踪恶意；<br>
    > 追责过程可编程，大幅提高效率。


#### 三、区块链发挥的作用

目前业界把区块链分为三类：公链、联盟链和私链。

(A). **公链**区块链的巨大魅力，源于除 _无中心实体控制这个系统_ 外的两个重要性质：<br>
- **不可变性**。基于 hash 指针的数据结构是不可变性的理论基础，而 _**大多数诚实**的算力（或权益）_ 才是不可变性的强有力保障；
    > 不可变性的潜在价值基础是**数据正确性**（即：**可信性**）。大多数诚实的算力（或权益）首先保障的就是数据正确性。
- **可证明性**。基于 _大多数算力（或权益）是诚实的_ 这样一个 _事实上基本成立_ 的假设，意味着所有被写入区块的数据（交易记录或 hash 存证）都是经由
算力投票而正确无误的，也就意味着每一个数据条目（一条交易记、一个 hash 等）都拥有一个与之对应的连接到区块头`MerkelRoot`的`MerkelTree`路径。即：
    > `数据写进区块`的本质是数据获得了其在区块中存在的完整密码学证明。
    >
    > 该证明基于：<br>
    > 1. 从创世区块开始到最新区块的完整区块头链条被验证是正确（无差错）的；<br>
    > 2. 在正确的前提下该链条是最长的；以及<br>
    > 3. 数据条目拥有从其自身 hash 链接到对应区块头`MerkelRoot`的正确`MerkelTree`路径。

由此可以得出如下**推论[`3-a-1`]**：
#### 某区块的 _独立数据包形式_ 只是一种逻辑形式，在工程实施上 _并非必要_。
即：可以用任何形式存储任何区块的数据，只要这些数据条目能够被快速查找，并能**获得其存在于某区块上的证明**（`MerkelTree`路径），即说明该数据条目在某区块内。[Bip152](https://github.com/bitcoin/bips/blob/master/bip-0152.mediawiki) 提出的低带宽区块转播协议即证明了这一点。

* 后文将公链称为 _传统公链_，以示区别。


(B). **联盟链**没有具体定义，最初的目的旨在让参与方都是经过授权的，而不是像公链一样任何人都可以参与。在联盟链中，通常不需要算力（或权益）去保障不可变性，不仅由于没必要浪费 _巨大的算力（能源）成本_，还因为
联盟链已经不是一个单纯的金钱系统，而是业务系统，首要解决的是对**数据正确性**的需求（没有正确性，不可变性便毫无意义）。
而由于在联盟链中，业务数据被恶意篡改造成的损失，往往要远大于激励措施获得的收益。因此即使参与各方都经过授权，仍存在联合作弊的动机，使得基于投票的共识机制和激励措施
- **无法让联盟链获得与公链相当的性质**。那么，如果仅仅从**数据一致性存储**角度去考虑联盟链又如何呢？根据`推论3-a-1`可知，_区块链不局限于某一种数据存储形式_。或者说，单纯地
- **借鉴公链的数据存储结构也不能获得任何公链性质**从而解决任何问题。于是在联盟链的具体实施逻辑中，_**任何参与方需要无条件地信任其它参与方**_，承认对方写入数据的正确性。如果不信任对方，则根本没有机制去解决。即：
- **联盟链并不能解决信任问题**。那么，使用联盟链后，
- **唯一对系统有帮助的只有p2p网络**。不过，如果只是为了这个，
- **他们根本不需要区块链**。综上可知，

#### _对"联盟链"的需求是伪需求，联盟链亦是一个伪命题。_


(C). **私链**没有存在的必要。原因同联盟链（略）。


> 不过，虽然联盟链并不能解决信任问题，但如果有某授权参与方 A 确实是可信的，如：公安机关。而且只有 A 能写入数据，那么起码 _在这种模式下系统是无漏洞的_。于是，我们可以基于该
**联盟链在写入方确实可信的前提下无漏洞**的性质，力争使系统变得**有用**。

因此，根据本模型业务场景的特殊需求，我们提出了**特定领域公链**（domain-specific blockchain）的概念，简称**定域链**（DSBlockchain）。只不过这个"公链"不同于传统公链，可理解为 _全民参与的联盟链_。
定域链不需要共识和激励机制（或者说，共识就是无条件信任公安，现实世界正是如此），只有公安可往链上写入数据（其它节点只读同步），是完全可信的，这保障了 _数据正确性_。基于此，_不可变性_ 亦得以保障。
由此可见，**特定领域公链具备传统公链的性质**。在本模型中，特定领域公链作为轻量级辅助网络，可低侵入地连接已有的各服务提供方系统，成为连接各不同业务实体促进信息交换的纽带。

特定领域公链所具备的性质，保障了以下能力得以实现：
1. ID 生命周期的状态转换。借鉴自源于比特币的`UTXO`模型：**数据在交易 _流转链路_ 上的最新状态才是当前的有效状态**，则：ID 的生命周期状态可以沿用此规则；
2. 公安的绝对控制权。只有公安有写入权限，根据第`1`条，ID 的状态是可控的：写入权即控制权；
3. 全民参与。任何单位实体和个人都可以运行全节点（或轻节点），可极大地发挥本系统在区块链语境下的功能优势；
4. 身份的本地核验。基于区块链（任何节点）上数据的**可信性**，通过节点本地数据即可对任何身份 ID 进行核验。该能力基于以下潜在要求或事实：
    > 公安对链上数据真实性负责（公安是数据的唯一写入方）。真实性包括 ID 生命周期的全部状态和其他信息。
5. 面对面身份核验。用户之间通过手机 App 即可互验身份（通过私钥签名机制，以及对公安服务接口的对方信息请求）；
6. 替代 CA。基于区块链数据的可证明性，可将某些证明信息写在链上以替代证书的颁发过程。例如：被验证者能够通过提供正确的`MerkelTree`路径证明自己的 ID 在链上，核验者也可以通过
使用布隆过滤器去链上查找该 ID 的最新状态，以获得其有效性等更多信息；这特别适用于轻节点如手机 App；
7. ID 挂失与变更交接。用户（公民）在 ID 发生状况（疑似私钥被盗、被冒用、信息被追踪等）时，可向公安申请挂失并重新获得新 ID。公安信息系统内部可存储某 ID 的变更交接历史（以备
用于信息追溯，处理警情），而不对外部公链广播（可在私有子链上记录 ID 交接），以增强隐私性；
    > 外部系统看到的是一个 ID 的终止和另一个 ID 的产生。由于用户量较大，可以产生混淆效果。以避免用户的 ID 变更被不法分子继续追踪。
8. 分散化与负载均衡。借助区块链的分散化特性，上述第`4`条使得部分业务操作不需要通过网络，分担了公安服务接口的压力；除此之外，结合公安数据由各地区分散存储的特点，链上的
ID -> url 数据结构使得本模型的区块链网络**将对不同 ID 的详细信息请求分发给了不同行政区域的公安服务接口**，起到负载均衡器的作用；
    > 这里的 url 是该 ID 所代表的公民数据存储位置，具体指该公民所在地区公安局的信息服务接口地址。
9. 泛化推广，交叉应用。各服务提供方均可加入区块链网络，以实现全网不同领域、不同业务实体间的互连接，使数据交换更加便捷，事务处理更有效率。


#### 有理由相信，基于此契机提出的**特定领域公链**将成为下一代区块链设计理念的典范，是区块链从 _自由主义_ 走向 _实用主义_ 的转折点。


#### 四、实施步骤
（待续）

### 五、应用示例

通过 ID 去租赁房屋，合同签订即可获得参与各方住址。确保信息的一致性。

（待续）
